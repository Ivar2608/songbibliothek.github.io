<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Heitzify Songbibliothek</title>
    
    <!-- PWA Manifest & Meta -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#0f172a">
    <link rel="apple-touch-icon" href="https://placehold.co/192x192/06b6d4/ffffff?text=H">
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Tailwind Config -->
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Exo 2', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Exo+2:wght@400;600;700&display=swap" rel="stylesheet">
    
    <style>
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Exo 2', sans-serif;
            background-color: #f8fafc;
            color: #0f172a;
            overflow-x: hidden;
        }
        .dark body { background-color: #0f172a; color: #f1f5f9; }
        
        .gradient-bg {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(-45deg, #f1f5f9, #e0f2fe, #eff6ff, #f8fafc);
            background-size: 400% 400%;
            animation: gradient 15s ease infinite;
            z-index: -1;
        }
        .dark .gradient-bg {
            background: linear-gradient(-45deg, #0f172a, #1e1b4b, #312e81, #0f172a);
        }
        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .glass-panel {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.8);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        .dark .glass-panel {
            background: rgba(15, 23, 42, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.05);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
        }

        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; border: 2px solid transparent; background-clip: content-box; }
        .dark ::-webkit-scrollbar-thumb { background: #475569; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        .dark ::-webkit-scrollbar-thumb:hover { background: #64748b; }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .song-item { animation: fadeInUp 0.4s ease-out forwards; opacity: 0; }
        
        .highlight { background-color: rgba(6, 182, 212, 0.2); color: #0891b2; border-radius: 2px; padding: 0 2px; font-weight: 700; }
        .dark .highlight { background-color: rgba(34, 211, 238, 0.3); color: #22d3ee; }

        .filter-active { background-color: #06b6d4 !important; color: white !important; border-color: #06b6d4 !important; }
        .view-section { display: none; }
        .view-section.active { display: block; animation: fadeInUp 0.5s ease-out; }
        
        .heart-icon { transition: transform 0.2s, color 0.2s; cursor: pointer; }
        .heart-icon:active { transform: scale(1.3); }
        .heart-active { color: #ec4899; fill: #ec4899; } 
    </style>
</head>
<body class="antialiased transition-colors duration-500 text-slate-900 dark:text-slate-100">

    <div id="bg-animation" class="gradient-bg"></div>

    <div class="container mx-auto p-4 sm:p-6 md:p-8 relative z-10 flex flex-col min-h-screen">
        
        <!-- Header -->
        <header class="relative text-center mb-8 pt-4">
            <div class="inline-block mb-2 px-3 py-1 rounded-full bg-cyan-100 border border-cyan-200 text-cyan-800 dark:bg-cyan-500/10 dark:border-cyan-500/20 dark:text-cyan-400 text-xs font-bold tracking-widest uppercase backdrop-blur-sm transition-colors duration-300">
                UltraStar Deluxe Extension
            </div>
            <h1 onclick="switchView('home')" class="text-5xl md:text-6xl font-bold bg-gradient-to-r from-cyan-600 via-blue-600 to-fuchsia-600 dark:from-cyan-500 dark:via-blue-500 dark:to-fuchsia-500 text-transparent bg-clip-text pb-2 px-4 drop-shadow-sm transition-all duration-300 cursor-pointer hover:opacity-90">
                Heitzify
            </h1>
            <p class="text-slate-600 dark:text-slate-300 mt-2 text-lg font-light">
                Die moderne Songbibliothek für dein Karaoke-Erlebnis.
            </p>
            
            <!-- VERSION BADGE (New) -->
            <div class="mt-4 flex justify-center">
                <span class="px-3 py-1 bg-white/50 dark:bg-slate-800/50 backdrop-blur-sm border border-slate-200 dark:border-slate-700 rounded-full text-xs font-mono text-slate-500 dark:text-slate-400 flex items-center gap-2">
                    <span class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></span>
                    Aktuelle Version: v1.0 (27.11.2025)
                </span>
            </div>
            
            <!-- Navigation Bar -->
            <nav class="flex justify-center gap-4 mt-6">
                <button onclick="switchView('home')" class="px-4 py-2 rounded-lg text-sm font-medium transition-colors hover:bg-slate-200 dark:hover:bg-slate-800 text-slate-600 dark:text-slate-300">Bibliothek</button>
                <button onclick="switchView('downloads')" class="px-4 py-2 rounded-lg text-sm font-medium transition-colors hover:bg-slate-200 dark:hover:bg-slate-800 text-slate-600 dark:text-slate-300 flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" /></svg>
                    Downloads
                </button>
            </nav>
            
            <button id="theme-toggle" class="absolute top-0 right-0 p-3 rounded-full glass-panel text-slate-800 dark:text-slate-200 hover:scale-110 transition-transform duration-300 shadow-lg focus:outline-none focus:ring-2 focus:ring-cyan-500" aria-label="Toggle Dark Mode">
                <svg id="theme-icon-light" class="w-5 h-5 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>
                <svg id="theme-icon-dark" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></svg>
            </button>
        </header>

        <!-- MAIN CONTENT AREA -->
        <main class="flex-grow max-w-5xl mx-auto w-full space-y-8">
            
            <!-- HOME VIEW -->
            <div id="home-view" class="view-section active space-y-8">
                <!-- Song of Day & Stats & List -->
                <section id="song-of-day-card" class="glass-panel p-6 rounded-2xl relative overflow-hidden border-l-4 border-yellow-400">
                    <div class="absolute top-0 right-0 p-4 opacity-10">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-32 w-32 text-yellow-500" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd" /></svg>
                    </div>
                    <h3 class="text-sm font-bold uppercase tracking-wider text-yellow-600 dark:text-yellow-400 mb-2 flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" /></svg>
                        Song des Tages
                    </h3>
                    <div class="relative z-10">
                        <p class="text-2xl md:text-3xl font-bold text-slate-800 dark:text-slate-100" id="sod-title">Lade...</p>
                        <p class="text-lg text-slate-600 dark:text-slate-300" id="sod-artist">...</p>
                        <div id="sod-tags" class="flex gap-2 mt-3"></div>
                        <button id="sod-play-btn" class="mt-4 px-4 py-2 bg-yellow-500 hover:bg-yellow-600 text-white rounded-lg flex items-center gap-2 transition-colors text-sm font-bold">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="currentColor" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
                            Jetzt singen
                        </button>
                    </div>
                </section>

                <section id="stats" class="grid grid-cols-1 sm:grid-cols-3 gap-4 md:gap-6">
                    <div class="glass-panel p-6 rounded-2xl text-center transform hover:-translate-y-1 transition-transform duration-300">
                        <h2 class="text-sm font-bold uppercase tracking-wide text-slate-600 dark:text-slate-400">Songs</h2>
                        <p id="total-songs" class="text-4xl font-bold text-cyan-600 dark:text-cyan-400 mt-1">0</p>
                    </div>
                    <div class="glass-panel p-6 rounded-2xl text-center transform hover:-translate-y-1 transition-transform duration-300">
                        <h2 class="text-sm font-bold uppercase tracking-wide text-slate-600 dark:text-slate-400">Künstler</h2>
                        <p id="unique-artists" class="text-4xl font-bold text-fuchsia-600 dark:text-fuchsia-400 mt-1">0</p>
                    </div>
                    <div class="glass-panel p-6 rounded-2xl text-center transform hover:-translate-y-1 transition-transform duration-300">
                        <h2 class="text-sm font-bold uppercase tracking-wide text-slate-600 dark:text-slate-400">Top Favorit</h2>
                        <p id="top-artist" class="text-2xl md:text-3xl font-bold text-blue-600 dark:text-blue-400 mt-2 truncate">-</p>
                    </div>
                </section>

                <section class="glass-panel rounded-2xl overflow-hidden">
                    <div class="p-6 md:p-8 border-b border-slate-200 dark:border-slate-700/30">
                        <div class="flex justify-between items-center mb-6">
                            <div>
                                <h2 class="text-2xl font-bold text-slate-900 dark:text-slate-100">Bibliothek durchsuchen</h2>
                                <p class="text-sm text-slate-500 dark:text-slate-400">Finde deinen nächsten Hit.</p>
                            </div>
                            <button id="show-favorites-btn" class="p-2 rounded-lg border border-slate-300 dark:border-slate-600 text-slate-500 dark:text-slate-400 hover:text-pink-500 dark:hover:text-pink-400 hover:border-pink-300 transition-colors" title="Nur Favoriten anzeigen">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" /></svg>
                            </button>
                        </div>
                        <div class="flex flex-col gap-4 mt-6">
                            <div class="flex flex-col md:flex-row gap-3">
                                <div class="relative flex-grow group">
                                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"><svg class="h-5 w-5 text-slate-400 group-focus-within:text-cyan-500 transition-colors" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg></div>
                                    <input type="text" id="search-input" placeholder="Titel oder Künstler suchen..." class="w-full pl-10 p-3 bg-white dark:bg-slate-800/50 border border-slate-300 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-cyan-500 focus:border-transparent outline-none transition-all duration-300 text-slate-900 dark:text-slate-100 placeholder-slate-400 shadow-sm">
                                </div>
                                <select id="artist-filter" class="p-3 bg-white dark:bg-slate-800/50 border border-slate-300 dark:border-slate-700 rounded-xl focus:ring-2 focus:ring-cyan-500 outline-none text-slate-900 dark:text-slate-100 w-full md:w-64 transition-all duration-300 cursor-pointer shadow-sm"><option value="all">Alle Künstler</option></select>
                                <button id="random-song-btn" class="p-3 bg-gradient-to-r from-cyan-500 to-blue-500 text-white rounded-xl hover:shadow-lg hover:scale-105 transition-all duration-300 font-semibold flex items-center justify-center gap-2 whitespace-nowrap shadow-md shadow-cyan-500/20"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M15.33 3.52a.75.75 0 01.428 1.316l-3.033 3.033a1.5 1.5 0 01-2.122 0L7.57 4.836A.75.75 0 018.63 3.77l1.745 1.745a.25.25 0 00.354 0L13.5 2.744a.75.75 0 011.33.428L12.5 5.5h2.75a.75.75 0 010 1.5H12.5l2.33 2.33a.75.75 0 11-1.06 1.06L10.738 7.357a1.5 1.5 0 010-2.122L13.77 2.2a.75.75 0 011.56.54v2.78zm-10 4.15a.75.75 0 11-1.06-1.06L7.303 3.577a1.5 1.5 0 012.122 0l3.033 3.033a.75.75 0 11-1.06 1.06L8.36 4.637a.25.25 0 00-.354 0L5.262 7.382zM4.67 15.17a.75.75 0 01-1.33-.428L5.5 12.36V9.75a.75.75 0 011.5 0V12.5l-2.33 2.33a.75.75 0 01-1.06-1.06l3.033-3.033a1.5 1.5 0 012.122 0l3.033 3.033a.75.75 0 01-1.06 1.06L9.262 12.618a.25.25 0 00-.354 0l-2.745 2.745z" clip-rule="evenodd" /></svg>Zufall</button>
                            </div>
                            <div class="flex gap-2">
                                <button id="sort-by-title" class="px-4 py-1.5 text-sm font-medium rounded-lg transition-all duration-300 border border-transparent">Titel</button>
                                <button id="sort-by-artist" class="px-4 py-1.5 text-sm font-medium rounded-lg transition-all duration-300 border border-transparent">Künstler</button>
                            </div>
                        </div>
                    </div>
                    <div class="bg-slate-50/80 dark:bg-slate-900/30 backdrop-blur-sm">
                        <div class="overflow-y-auto max-h-[60vh] p-4" id="scroll-container"><ul id="song-list" class="space-y-3"></ul></div>
                    </div>
                </section>
                
                <section class="glass-panel p-6 rounded-2xl border-l-4 border-fuchsia-500">
                    <h2 class="text-xl font-bold text-slate-800 dark:text-slate-100 mb-3 flex items-center gap-2"><span class="inline-block w-2 h-2 rounded-full bg-fuchsia-500 animate-pulse"></span> Coming Soon</h2>
                    <div class="flex flex-wrap gap-2">
                        <span class="px-3 py-1 bg-fuchsia-100 text-fuchsia-800 dark:bg-fuchsia-900/30 dark:text-fuchsia-300 rounded-full text-xs font-medium border border-fuchsia-200 dark:border-fuchsia-800">Disneys High School Musical</span>
                        <span class="px-3 py-1 bg-fuchsia-100 text-fuchsia-800 dark:bg-fuchsia-900/30 dark:text-fuchsia-300 rounded-full text-xs font-medium border border-fuchsia-200 dark:border-fuchsia-800">Classic Schlager</span>
                        <span class="px-3 py-1 bg-fuchsia-100 text-fuchsia-800 dark:bg-fuchsia-900/30 dark:text-fuchsia-300 rounded-full text-xs font-medium border border-fuchsia-200 dark:border-fuchsia-800">Rock & Pop Classics</span>
                    </div>
                </section>
            </div>

            <!-- DOWNLOADS VIEW -->
            <div id="downloads-view" class="view-section hidden">
                <div class="glass-panel p-8 rounded-2xl shadow-xl max-w-3xl mx-auto">
                    <h2 class="text-3xl font-bold mb-6 text-slate-800 dark:text-slate-100 border-b border-slate-200 dark:border-slate-700 pb-4">Downloads</h2>
                    <p class="text-slate-600 dark:text-slate-300 mb-8">Hier findest du in Zukunft die Links zum Herunterladen der UltraStar Deluxe Software und der aktualisierten Song-Pakete.</p>
                    
                    <div class="space-y-6">
                        <!-- Main Software Download -->
                        <div class="bg-white/50 dark:bg-slate-800/50 p-6 rounded-xl border border-slate-200 dark:border-slate-700 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4">
                            <div>
                                <div class="flex items-center gap-3 mb-1">
                                    <h3 class="font-bold text-lg text-slate-800 dark:text-slate-100">Heitzify UltraStar Paket</h3>
                                    <span class="px-2 py-0.5 rounded text-[10px] font-bold bg-cyan-100 text-cyan-700 dark:bg-cyan-900/30 dark:text-cyan-300 border border-cyan-200 dark:border-cyan-800">v1.0</span>
                                </div>
                                <p class="text-sm text-slate-500 dark:text-slate-400 mb-2">Das komplette Paket inklusive Software & Songs.</p>
                                <p class="text-xs text-slate-400 dark:text-slate-500 flex items-center gap-1 font-mono">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" /></svg>
                                    Stand: 27.11.2025
                                </p>
                            </div>
                            <a href="https://drive.google.com/drive/folders/1oKK6dnhseenuEKGopc15DfZK2g84ZSXy?usp=sharing" target="_blank" class="px-6 py-2.5 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg font-medium w-full sm:w-auto text-center shadow-lg shadow-cyan-500/20 transition-all transform hover:scale-105 flex items-center justify-center gap-2">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" /></svg>
                                Download
                            </a>
                        </div>

                        <!-- Song Update Download -->
                        <div class="bg-white/50 dark:bg-slate-800/50 p-6 rounded-xl border border-slate-200 dark:border-slate-700 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4">
                            <div>
                                <div class="flex items-center gap-3 mb-1">
                                    <h3 class="font-bold text-lg text-slate-800 dark:text-slate-100">Songbibliothek Update</h3>
                                    <span class="px-2 py-0.5 rounded text-[10px] font-bold bg-cyan-100 text-cyan-700 dark:bg-cyan-900/30 dark:text-cyan-300 border border-cyan-200 dark:border-cyan-800">v1.0</span>
                                </div>
                                <p class="text-sm text-slate-500 dark:text-slate-400 mb-2">Nur die neuen Lieder für dein bestehendes Spiel.</p>
                                <p class="text-xs text-slate-400 dark:text-slate-500 flex items-center gap-1 font-mono">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" /></svg>
                                    Stand: 27.11.2025
                                </p>
                            </div>
                            <a href="https://drive.google.com/drive/folders/1QwVTrN9BqlEkIeP4UTQx3SFrDQ_7aK_2?usp=sharing" target="_blank" class="px-6 py-2.5 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg font-medium w-full sm:w-auto text-center shadow-lg shadow-cyan-500/20 transition-all transform hover:scale-105 flex items-center justify-center gap-2">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" /></svg>
                                Download
                            </a>
                        </div>
                    </div>
                    
                    <div class="mt-8 p-4 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-700 rounded-lg text-sm text-yellow-800 dark:text-yellow-200 flex gap-3">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 flex-shrink-0" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" /></svg>
                        <p><strong>Hinweis:</strong> Die Downloads werden über Google Drive bereitgestellt. Bitte beachte unsere Datenschutzerklärung bezüglich externer Links.</p>
                    </div>
                    
                    <button onclick="switchView('home')" class="mt-8 px-6 py-2 bg-slate-200 dark:bg-slate-700 rounded-lg hover:bg-slate-300 dark:hover:bg-slate-600 transition-colors">Zurück zur Übersicht</button>
                </div>
            </div>

            <!-- IMPRESSUM VIEW -->
            <div id="impressum-view" class="view-section hidden">
                <div class="glass-panel p-8 rounded-2xl shadow-xl max-w-3xl mx-auto">
                    <h2 class="text-3xl font-bold mb-6 text-slate-800 dark:text-slate-100 border-b border-slate-200 dark:border-slate-700 pb-4">Impressum</h2>
                    <div class="space-y-4 text-slate-700 dark:text-slate-300">
                        <p class="font-bold">Angaben gemäß § 5 TMG</p>
                        <p>Dennis Heitz<br>Postfach 10 14 26<br>33514 Bielefeld</p>
                        <p class="font-bold mt-6">Kontakt</p>
                        <p>E-Mail: <a href="mailto:dennis.heitz1@gmail.com" class="text-cyan-600 dark:text-cyan-400 hover:underline">dennis.heitz1@gmail.com</a></p>
                        <button onclick="switchView('home')" class="mt-8 px-6 py-2 bg-slate-200 dark:bg-slate-700 rounded-lg hover:bg-slate-300 dark:hover:bg-slate-600 transition-colors">Zurück zur Übersicht</button>
                    </div>
                </div>
            </div>

            <!-- DATENSCHUTZ VIEW -->
            <div id="datenschutz-view" class="view-section hidden">
                <div class="glass-panel p-8 rounded-2xl shadow-xl max-w-3xl mx-auto">
                    <h2 class="text-3xl font-bold mb-6 text-slate-800 dark:text-slate-100 border-b border-slate-200 dark:border-slate-700 pb-4">Datenschutzerklärung</h2>
                    <div class="space-y-4 text-slate-700 dark:text-slate-300 text-sm leading-relaxed">
                        <h3 class="text-xl font-bold text-slate-900 dark:text-slate-100 mt-4">1. Datenerfassung auf dieser Website</h3>
                        <p><strong>Cookies & Local Storage:</strong><br>Wir nutzen den "Local Storage" Ihres Browsers, um Ihre Einstellungen (z.B. Dark Mode, Cookie-Zustimmung) und <strong>Ihre persönliche Favoritenliste (Merkzettel)</strong> lokal auf Ihrem Gerät zu speichern. Diese Daten werden nicht an uns übertragen.</p>
                        
                        <h3 class="text-xl font-bold text-slate-900 dark:text-slate-100 mt-4">2. Externe Links (YouTube)</h3>
                        <p>Unsere Webseite enthält Links zur Plattform YouTube. Diese sind mit einem "Play"-Symbol gekennzeichnet. Erst wenn Sie auf diesen Link klicken, werden Sie zu YouTube weitergeleitet. Ab diesem Zeitpunkt gelten die Datenschutzbestimmungen von YouTube.</p>

                        <h3 class="text-xl font-bold text-slate-900 dark:text-slate-100 mt-4">3. Externe Links (Google Drive)</h3>
                        <p>Für den Download von Dateien verweisen wir auf Google Drive. Wenn Sie einen Download-Link anklicken, werden Sie zu den Servern von Google weitergeleitet. Hierbei gelten die Datenschutzbestimmungen von Google. Wir haben keinen Zugriff auf die Daten, die Google bei der Nutzung seiner Dienste erhebt.</p>
                        
                        <button onclick="switchView('home')" class="mt-8 px-6 py-2 bg-slate-200 dark:bg-slate-700 rounded-lg hover:bg-slate-300 dark:hover:bg-slate-600 transition-colors">Zurück zur Übersicht</button>
                    </div>
                </div>
            </div>
        </main>
        
        <footer class="text-center mt-16 pb-8 px-4">
            <div class="max-w-2xl mx-auto border-t border-slate-300/50 dark:border-slate-200/20 pt-8">
                <p class="text-lg font-bold text-slate-700 dark:text-slate-300 mb-2">Heitzify Songbibliothek</p>
                <p id="footer-song-count" class="text-sm text-cyan-600 dark:text-cyan-400 font-medium"></p>
                <div class="mt-6 flex justify-center gap-6 text-xs text-slate-500 dark:text-slate-400">
                    <button onclick="switchView('impressum')" class="hover:text-cyan-500 transition-colors">Impressum</button>
                    <button onclick="switchView('datenschutz')" class="hover:text-cyan-500 transition-colors">Datenschutz</button>
                    <button onclick="switchView('downloads')" class="hover:text-cyan-500 transition-colors">Downloads</button>
                    <button onclick="openCookieSettings()" class="hover:text-cyan-500 transition-colors">Cookie-Einstellungen</button>
                </div>
            </div>
        </footer>
    </div>
    
    <!-- Buttons & Modals -->
    <button id="back-to-top" class="hidden fixed bottom-6 right-6 bg-slate-800 dark:bg-slate-700 text-white dark:text-slate-200 p-3 rounded-full shadow-2xl hover:-translate-y-1 transition-all duration-300 z-40 focus:outline-none ring-4 ring-transparent focus:ring-cyan-500/50"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5"><path stroke-linecap="round" stroke-linejoin="round" d="M5 15l7-7 7 7" /></svg></button>
    <div id="cookie-banner" class="fixed bottom-0 left-0 w-full z-50 p-4 md:p-6 hidden"><div class="glass-panel bg-white dark:bg-slate-900 max-w-4xl mx-auto rounded-xl shadow-2xl p-6 md:flex items-center justify-between gap-6 border-t-4 border-cyan-500"><div class="text-sm text-slate-700 dark:text-slate-300 mb-4 md:mb-0"><h4 class="font-bold text-lg mb-1">Privatsphäre-Einstellungen</h4><p>Wir nutzen Cookies und Local Storage für Funktionen wie die Merkliste.</p></div><div class="flex gap-3 flex-shrink-0"><button onclick="acceptCookies('essential')" class="px-4 py-2 text-sm font-medium text-slate-600 dark:text-slate-300 bg-slate-200 dark:bg-slate-800 rounded-lg">Nur Notwendige</button><button onclick="acceptCookies('all')" class="px-4 py-2 text-sm font-medium text-white bg-cyan-600 hover:bg-cyan-700 rounded-lg">Alle Akzeptieren</button></div></div></div>
    <div id="random-song-modal" class="fixed inset-0 bg-slate-900/80 backdrop-blur-sm flex items-center justify-center p-4 z-50 opacity-0 pointer-events-none transition-all duration-300"><div class="glass-panel bg-white dark:bg-slate-800 rounded-2xl shadow-2xl w-full max-w-md transform scale-95 transition-all duration-300 border border-slate-200/20 overflow-hidden relative"><div class="p-8 text-center"><h3 class="text-xl font-bold text-slate-800 dark:text-slate-100 mb-1">Zufallstreffer!</h3><div class="py-4 px-2 rounded-xl bg-slate-100 dark:bg-slate-900/50 border border-slate-200 dark:border-slate-700/50 mb-6"><p class="text-2xl font-bold bg-gradient-to-r from-cyan-600 to-blue-600 dark:from-cyan-500 dark:to-blue-500 text-transparent bg-clip-text" id="random-song-title">-</p><p class="text-md font-medium text-slate-600 dark:text-slate-300 mt-1" id="random-song-artist">-</p></div><div class="flex gap-3 justify-center"><button id="close-modal-btn" class="px-6 py-2.5 bg-slate-200 dark:bg-slate-700 text-slate-800 dark:text-slate-200 rounded-xl">Schließen</button><button id="reroll-btn" class="px-6 py-2.5 bg-cyan-500 text-white rounded-xl">Nochmal</button></div></div></div></div>

    <script>
        // --- JS LOGIC ---
        let switchView, acceptCookies, openCookieSettings, openYoutube;
        document.addEventListener('DOMContentLoaded', () => {
            // ... Elements ...
            const themeToggleBtn = document.getElementById('theme-toggle');
            const lightIcon = document.getElementById('theme-icon-light');
            const darkIcon = document.getElementById('theme-icon-dark');
            const bgAnimation = document.getElementById('bg-animation');
            const backToTopBtn = document.getElementById('back-to-top');
            const randomSongBtn = document.getElementById('random-song-btn');
            const randomSongModal = document.getElementById('random-song-modal');
            const closeModalBtn = document.getElementById('close-modal-btn');
            const rerollBtn = document.getElementById('reroll-btn');
            const randomSongTitleEl = document.getElementById('random-song-title');
            const randomSongArtistEl = document.getElementById('random-song-artist');
            const cookieBanner = document.getElementById('cookie-banner');
            const songListEl = document.getElementById('song-list');
            const searchInputEl = document.getElementById('search-input');
            const artistFilterEl = document.getElementById('artist-filter');
            const sortByTitleBtn = document.getElementById('sort-by-title');
            const sortByArtistBtn = document.getElementById('sort-by-artist');
            const showFavoritesBtn = document.getElementById('show-favorites-btn');
            const sodTitle = document.getElementById('sod-title');
            const sodArtist = document.getElementById('sod-artist');
            const sodTags = document.getElementById('sod-tags');
            const sodPlayBtn = document.getElementById('sod-play-btn');

            let currentSort = 'title';
            let showFavoritesOnly = false;
            let favorites = JSON.parse(localStorage.getItem('heitzify_favorites')) || [];

            // --- VIEW ---
            switchView = (viewName) => {
                document.querySelectorAll('.view-section').forEach(el => { el.classList.add('hidden'); el.classList.remove('active'); });
                const target = document.getElementById(viewName + '-view');
                if (target) { target.classList.remove('hidden'); setTimeout(() => target.classList.add('active'), 10); window.scrollTo({ top: 0, behavior: 'smooth' }); }
            };

            // --- COOKIE ---
            const checkCookieConsent = () => { if (!localStorage.getItem('cookieConsent')) cookieBanner.classList.remove('hidden'); };
            acceptCookies = (type) => { localStorage.setItem('cookieConsent', type); cookieBanner.classList.add('hidden'); };
            openCookieSettings = () => { cookieBanner.classList.remove('hidden'); };
            checkCookieConsent();

            // --- THEME ---
            const applyTheme = (theme) => {
                const lightIcon = document.getElementById('theme-icon-light');
                const darkIcon = document.getElementById('theme-icon-dark');
                if (theme === 'dark') { document.documentElement.classList.add('dark'); bgAnimation.classList.remove('light-mode-bg'); lightIcon.classList.remove('hidden'); darkIcon.classList.add('hidden'); }
                else { document.documentElement.classList.remove('dark'); bgAnimation.classList.add('light-mode-bg'); lightIcon.classList.add('hidden'); darkIcon.classList.remove('hidden'); }
            };
            const savedTheme = localStorage.getItem('theme') || 'dark'; applyTheme(savedTheme);
            themeToggleBtn.addEventListener('click', () => { const isDark = document.documentElement.classList.contains('dark'); const newTheme = isDark ? 'light' : 'dark'; localStorage.setItem('theme', newTheme); applyTheme(newTheme); });

            // --- SCROLL ---
            window.addEventListener('scroll', () => { if (window.scrollY > 300) backToTopBtn.classList.remove('hidden'); else backToTopBtn.classList.add('hidden'); });
            backToTopBtn.addEventListener('click', () => window.scrollTo({ top: 0, behavior: 'smooth' }));

            // --- PWA ---
            if ('serviceWorker' in navigator) { window.addEventListener('load', () => navigator.serviceWorker.register('sw.js')); }

            // --- DATA (Enhanced with Tags) ---
            const songData = [
                { artist: "ABBA", title: "Mamma Mia", tags: ["Pop", "70er", "Oldie"] },
                { artist: "AnnenMayKantereit", title: "Ausgehen", tags: ["Rock", "Pop", "Deutsch"] },
                { artist: "AnnenMayKantereit", title: "Barfuß am Klavier", tags: ["Ballade", "Deutsch"] },
                { artist: "AnnenMayKantereit", title: "Oft gefragt", tags: ["Deutsch", "Rock"] },
                { artist: "AnnenMayKantereit", title: "Pocahontas", tags: ["Deutsch", "Hit"] },
                { artist: "Banaroo", title: "Dubi Dam Dam", tags: ["Pop", "Party"] },
                { artist: "Billy Joel", title: "Uptown Girl", tags: ["Oldie", "Pop"] },
                { artist: "Coldplay", title: "Speed Of Sound (Album Version)", tags: ["Rock", "Alternative"] },
                { artist: "Disney", title: "Ein Traum wird wahr (Aladdin) [DUET]", tags: ["Disney", "Duett", "Soundtrack"] },
                { artist: "Disney", title: "Prinz Ali (Aladdin)", tags: ["Disney", "Soundtrack"] },
                { artist: "Disney", title: "Nur ein Kuss (Arielle)", tags: ["Disney", "Ballade"] },
                { artist: "Disney", title: "Unter dem Meer (Arielle)", tags: ["Disney", "Gute Laune"] },
                { artist: "Disney", title: "Katzen brauchen furchtbar viel Musik (Aristocats) [DUET]", tags: ["Disney", "Duett"] },
                { artist: "Disney", title: "Intro (Chip & Chap)", tags: ["Disney", "TV-Theme"] },
                { artist: "Disney", title: "Ich wäre gern wie Du (Das Dschungelbuch)", tags: ["Disney", "Jazz"] },
                { artist: "Disney", title: "Ich wäre gern wie Du (Das Dschungelbuch) [DUET]", tags: ["Disney", "Duett"] },
                { artist: "Disney", title: "Probier's mal mit Gemütlichkeit (Das Dschungelbuch)", tags: ["Disney", "Klassiker"] },
                { artist: "Disney", title: "Lass jetzt los (Die Eiskönigin)", tags: ["Disney", "Hit", "Ballade"] },
                { artist: "Disney", title: "Theme (DuckTales)", tags: ["Disney", "TV-Theme"] },
                { artist: "Disney", "title": "Druck (Encanto)", tags: ["Disney", "Modern"] },
                { artist: "Disney", title: "Theme (Gummibärenbande)", tags: ["Disney", "TV-Theme"] },
                { artist: "Disney", title: "Ich werd's noch beweisen! (Hercules)", tags: ["Disney", "Ballade"] },
                { artist: "Disney", title: "Ich will keinen Mann (Hercules)", tags: ["Disney", "Pop"] },
                { artist: "Disney", title: "Intro (Käpt'n Balu und seine tollkühne Crew)", tags: ["Disney", "TV-Theme"] },
                { artist: "Disney", title: "Der ewige Kreis (Der König der Löwen) [DUET]", tags: ["Disney", "Duett", "Klassiker"] },
                { artist: "Disney", title: "Hakuna Matata (Der König der Löwen)", tags: ["Disney", "Gute Laune"] },
                { artist: "Disney", title: "Hakuna Matata (Der König der Löwen) [DUET]", tags: ["Disney", "Duett"] },
                { artist: "Disney", title: "Ich will jetzt gleich König sein (Der König der Löwen)", tags: ["Disney", "Pop"] },
                { artist: "Disney", title: "Kann es wirklich Liebe sein (Der König der Löwen)", tags: ["Disney", "Ballade"] },
                { artist: "Disney", title: "Sei ein Mann (Mulan)", tags: ["Disney", "Power"] },
                { artist: "Disney", title: "Das Farbenspiel des Winds (Pocahontas)", tags: ["Disney", "Ballade"] },
                { artist: "Disney", title: "Zwei Welten (Tarzan Musical)", tags: ["Disney", "Musical"] },
                { artist: "Disney", title: "So ein Mann (Tarzan / Phil Collins)", tags: ["Disney", "Pop"] },
                { artist: "Disney", title: "Dir gehört mein Herz (Tarzan / Phil Collins & Eva Mattes)", tags: ["Disney", "Ballade"] },
                { artist: "Disney", title: "Du hast 'n Freund in mir (Toy Story)", tags: ["Disney", "Klassiker"] },
                { artist: "Disney", title: "Voll gerne (Vaiana / Andreas Bourani)", tags: ["Disney", "Pop"] },
                { artist: "Disney", title: "Ich bin bereit (Vaiana / Debbie van Dooren)", tags: ["Disney", "Power"] },
                { artist: "Disney", title: "Ich bin bereit (Vaiana / Helene Fischer)", tags: ["Disney", "Schlager"] },
                { artist: "DJ BoBo", title: "Chihuahua", tags: ["Party", "Sommer"] },
                { artist: "DJ Ötzi & Nik P.", title: "Ein Stern (... der deinen Namen trägt)", tags: ["Schlager", "Party"] },
                { artist: "Echt", title: "Du trägst keine Liebe in dir", tags: ["Deutsch", "90er"] },
                { artist: "Erste Allgemeine Verunsicherung", title: "Ding Dong", tags: ["Deutsch", "Spaß"] },
                { artist: "Extreme", title: "More Than Words [DUET]", tags: ["Ballade", "Duett", "Rock"] },
                { artist: "Geier Sturzflug", title: "Bruttosozialprodukt", tags: ["NDW", "Deutsch"] },
                { artist: "Helene Fischer", title: "Atemlos durch die Nacht", tags: ["Schlager", "Party"] },
                { artist: "Helene Fischer", title: "Herzbeben", tags: ["Schlager", "Pop"] },
                { artist: "Hermes House Band", title: "Country Roads", tags: ["Party", "Cover"] },
                { artist: "Hoobastank", title: "The Reason", tags: ["Rock", "Ballade"] },
                { artist: "Höhner", title: "Viva Colonia (Da simmer dabei, dat is prima!)", tags: ["Karneval", "Party"] },
                { artist: "John Denver", title: "Take Me Home, Country Roads", tags: ["Country", "Oldie"] },
                { artist: "Khaled", title: "Aïcha", tags: ["Pop", "90er"] },
                { artist: "Lady Gaga", title: "Paparazzi", tags: ["Pop", "Hit"] },
                { artist: "Leonard Cohen", title: "Hallelujah", tags: ["Ballade", "Klassiker"] },
                { artist: "Mark Forster", title: "Übermorgen", tags: ["Deutsch", "Pop"] },
                { artist: "Matthias Reim", title: "Verdammt - ich lieb' dich", tags: ["Schlager", "Kult"] },
                { artist: "Mickie Krause", title: "Laudato si", tags: ["Party", "Ballermann"] },
                { artist: "Olaf Henning", title: "Cowboy und Indianer (Komm hol' das Lasso raus)", tags: ["Party", "Schlager"] },
                { artist: "Oliver Pocher", title: "Schwarz und weiß", tags: ["Party", "Fußball"] },
                { artist: "Paramore", title: "Still Into You", tags: ["Rock", "Alternative"] },
                { artist: "Peter Maffay", title: "Und es war Sommer", tags: ["Schlager", "Klassiker"] },
                { artist: "Philipp Dittberner & Marv", title: "Wolke 4", tags: ["Deutsch", "Pop"] },
                { artist: "Philipp Poisel", title: "Ich will nur (Live)", tags: ["Deutsch", "Ballade"] },
                { artist: "Philipp Poisel", title: "Wie soll ein Mensch das ertragen", tags: ["Deutsch", "Traurig"] },
                { artist: "Pur", title: "Hitmix", tags: ["Schlager", "Medley"] },
                { artist: "Rednex", title: "Cotton Eye Joe", tags: ["Party", "90er"] },
                { artist: "Right Said Fred", title: "You're My Mate", tags: ["Pop", "Gute Laune"] },
                { artist: "Santiano", title: "Alle die mit uns auf Kaperfahrt fahren", tags: ["Shanty", "Deutsch"] },
                { artist: "Scorpions", title: "Wind Of Change", tags: ["Rock", "Ballade"] },
                { artist: "Tabaluga & Lilli", title: "Nessaja (Peter Maffay)", tags: ["Musical", "Deutsch"] },
                { artist: "Taylor Swift", title: "Anti-Hero", tags: ["Pop", "Aktuell"] },
                { artist: "Taylor Swift", title: "Bad Blood", tags: ["Pop", "Hit"] },
                { artist: "Taylor Swift", title: "Blank Space", tags: ["Pop", "Hit"] },
                { artist: "Taylor Swift", title: "Cruel Summer", tags: ["Pop", "Sommer"] },
                { artist: "Taylor Swift", title: "I Knew You Were Trouble", tags: ["Pop", "Dubstep"] },
                { artist: "Taylor Swift", title: "Karma", tags: ["Pop", "Hit"] },
                { artist: "Taylor Swift", title: "Miss Americana & The Heartbreak Prince", tags: ["Pop"] },
                { artist: "Taylor Swift feat. Ice Spice", title: "Karma", tags: ["Pop", "Remix"] },
                { artist: "Wir sind Helden", title: "Denkmal", tags: ["Deutsch", "Rock"] },
                { artist: "Wolfgang Petry", title: "Wahsinns (Live)", tags: ["Schlager", "Kult"] },
            ];

            // --- YOUTUBE LOGIC ---
            openYoutube = (artist, title) => {
                const query = encodeURIComponent(`${artist} ${title} Karaoke`);
                window.open(`https://www.youtube.com/results?search_query=${query}`, '_blank');
            };

            // --- SONG OF THE DAY ---
            const updateSongOfTheDay = () => {
                const today = new Date().toDateString(); 
                let hash = 0;
                for (let i = 0; i < today.length; i++) hash = today.charCodeAt(i) + ((hash << 5) - hash);
                const index = Math.abs(hash) % songData.length;
                const dailySong = songData[index];

                sodTitle.textContent = dailySong.title;
                sodArtist.textContent = dailySong.artist;
                
                sodTags.innerHTML = '';
                if(dailySong.tags) {
                    dailySong.tags.forEach(tag => {
                        const span = document.createElement('span');
                        span.className = "px-2 py-0.5 bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-200 text-xs rounded-full border border-yellow-200 dark:border-yellow-700/50";
                        span.textContent = tag;
                        sodTags.appendChild(span);
                    });
                }
                sodPlayBtn.onclick = () => openYoutube(dailySong.artist, dailySong.title);
            };
            updateSongOfTheDay();

            // --- FAVORITES LOGIC ---
            function toggleFavorite(songKey) {
                if (favorites.includes(songKey)) { favorites = favorites.filter(k => k !== songKey); } 
                else { favorites.push(songKey); }
                localStorage.setItem('heitzify_favorites', JSON.stringify(favorites));
                filterAndRender();
            }

            showFavoritesBtn.addEventListener('click', () => {
                showFavoritesOnly = !showFavoritesOnly;
                showFavoritesBtn.classList.toggle('bg-pink-100');
                showFavoritesBtn.classList.toggle('dark:bg-pink-900/30');
                showFavoritesBtn.classList.toggle('text-pink-600');
                showFavoritesBtn.classList.toggle('border-pink-500');
                filterAndRender();
            });

            // --- RENDER & FILTER ---
            function highlightMatch(text, term) {
                if (!term) return text;
                const regex = new RegExp(`(${term})`, 'gi');
                return text.replace(regex, '<span class="highlight">$1</span>');
            }

            // Expose for HTML
            window.toggleFav = (key) => toggleFavorite(key);
            window.playSong = (artist, title) => openYoutube(artist, title);

            function renderSongList(songs) {
                songListEl.innerHTML = '';
                if (songs.length === 0) {
                    songListEl.innerHTML = `<li class="flex flex-col items-center justify-center p-8 text-center animate-fade-in"><div class="w-16 h-16 mb-4 rounded-full bg-slate-100 dark:bg-slate-800 flex items-center justify-center"><svg class="w-8 h-8 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div><p class="text-slate-500 dark:text-slate-400 font-medium">Keine Songs gefunden.</p></li>`;
                    return;
                }

                const sortedSongs = [...songs].sort((a, b) => {
                    if (currentSort === 'artist') {
                        const artistCompare = a.artist.localeCompare(b.artist);
                        if (artistCompare !== 0) return artistCompare;
                    }
                    return a.title.localeCompare(b.title);
                });

                const searchTerm = searchInputEl.value.toLowerCase();

                sortedSongs.forEach((song, index) => {
                    const songKey = `${song.artist}-${song.title}`;
                    const isFav = favorites.includes(songKey);
                    const li = document.createElement('li');
                    li.style.animationDelay = `${index * 30}ms`;
                    li.className = 'song-item flex items-center p-3 md:p-4 rounded-xl bg-white/80 dark:bg-slate-800/40 hover:bg-white dark:hover:bg-slate-800/60 border border-transparent hover:border-cyan-500/30 shadow-sm hover:shadow-md transition-all duration-300 group cursor-default';
                    
                    const displayTitle = highlightMatch(song.title, searchTerm);
                    const displayArtist = highlightMatch(song.artist, searchTerm);
                    const heartClass = isFav ? "heart-active" : "text-slate-300 dark:text-slate-600 hover:text-pink-400";
                    const heartFill = isFav ? "currentColor" : "none";

                    // Tag Badges HTML
                    let tagsHtml = '';
                    if(song.tags) {
                        tagsHtml = `<div class="flex flex-wrap gap-1 mt-1">` + 
                            song.tags.map(tag => `<span class="px-1.5 py-0.5 text-[10px] rounded-md bg-slate-100 dark:bg-slate-700 text-slate-500 dark:text-slate-400 border border-slate-200 dark:border-slate-600">${tag}</span>`).join('') +
                        `</div>`;
                    }

                    li.innerHTML = `
                        <span class="text-slate-400 font-mono text-xs md:text-sm w-8 md:w-12 text-right mr-4 opacity-60 group-hover:opacity-100 transition-opacity">${index + 1}.</span>
                        <div class="flex-grow min-w-0">
                            <p class="font-bold text-slate-800 dark:text-slate-100 text-sm md:text-base group-hover:text-cyan-700 dark:group-hover:text-cyan-400 transition-colors truncate pr-2">${displayTitle}</p>
                            <p class="text-xs md:text-sm text-slate-600 dark:text-slate-400 font-medium mt-0.5 truncate">${displayArtist}</p>
                            ${tagsHtml}
                        </div>
                        <div class="flex items-center gap-3 ml-2 flex-shrink-0">
                             <button onclick="window.playSong('${song.artist.replace(/'/g, "\\'")}', '${song.title.replace(/'/g, "\\'")}')" class="p-2 rounded-full bg-slate-100 dark:bg-slate-700 text-slate-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors" title="Auf YouTube suchen">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clip-rule="evenodd" />
                                </svg>
                             </button>
                             <svg onclick="window.toggleFav('${songKey.replace(/'/g, "\\'")}')" class="w-6 h-6 heart-icon ${heartClass}" fill="${heartFill}" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
                             </svg>
                        </div>
                    `;
                    songListEl.appendChild(li);
                });
            }

            function setupFilters(uniqueArtists) {
                uniqueArtists.sort((a,b) => a.localeCompare(b)).forEach(artist => {
                    const option = document.createElement('option');
                    option.value = artist;
                    option.textContent = artist;
                    artistFilterEl.appendChild(option);
                });
            }
            
            function calculateAndDisplayStats() {
                const totalSongs = songData.length;
                const artists = songData.map(s => s.artist);
                const uniqueArtists = [...new Set(artists)];
                const artistCounts = artists.reduce((acc, artist) => { acc[artist] = (acc[artist] || 0) + 1; return acc; }, {});
                const topArtistEntry = Object.entries(artistCounts).sort((a, b) => b[1] - a[1])[0];
                
                animateValue("total-songs", 0, totalSongs, 1000);
                animateValue("unique-artists", 0, uniqueArtists.length, 1000);
                document.getElementById('top-artist').textContent = topArtistEntry ? `${topArtistEntry[0]} (${topArtistEntry[1]})` : '-';
                document.getElementById('footer-song-count').textContent = `${totalSongs} Songs in der Bibliothek`;
                return { uniqueArtists };
            }

            function animateValue(id, start, end, duration) {
                const obj = document.getElementById(id);
                let startTimestamp = null;
                const step = (timestamp) => {
                    if (!startTimestamp) startTimestamp = timestamp;
                    const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                    obj.innerHTML = Math.floor(progress * (end - start) + start);
                    if (progress < 1) window.requestAnimationFrame(step);
                };
                window.requestAnimationFrame(step);
            }

            function filterAndRender() {
                const searchTerm = searchInputEl.value.toLowerCase();
                const selectedArtist = artistFilterEl.value;
                artistFilterEl.classList.toggle('filter-active', selectedArtist !== 'all');

                const filteredSongs = songData.filter(song => {
                    const matchesSearch = song.title.toLowerCase().includes(searchTerm) || song.artist.toLowerCase().includes(searchTerm);
                    const matchesArtist = selectedArtist === 'all' || song.artist === selectedArtist;
                    const matchesFav = showFavoritesOnly ? favorites.includes(`${song.artist}-${song.title}`) : true;
                    return matchesSearch && matchesArtist && matchesFav;
                });
                renderSongList(filteredSongs);
            }
            
            function updateSortButtons() {
                const activeClass = "bg-cyan-500 text-white shadow-md shadow-cyan-500/20 border-transparent";
                const inactiveClass = "bg-slate-200 dark:bg-slate-700 text-slate-600 dark:text-slate-300 hover:bg-slate-300 dark:hover:bg-slate-600 border-transparent";
                if (currentSort === 'title') {
                    sortByTitleBtn.className = `px-4 py-1.5 text-sm font-medium rounded-lg transition-all duration-300 border ${activeClass}`;
                    sortByArtistBtn.className = `px-4 py-1.5 text-sm font-medium rounded-lg transition-all duration-300 border ${inactiveClass}`;
                } else {
                    sortByArtistBtn.className = `px-4 py-1.5 text-sm font-medium rounded-lg transition-all duration-300 border ${activeClass}`;
                    sortByTitleBtn.className = `px-4 py-1.5 text-sm font-medium rounded-lg transition-all duration-300 border ${inactiveClass}`;
                }
            }

            // Bind Events
            sortByTitleBtn.addEventListener('click', () => { currentSort = 'title'; updateSortButtons(); filterAndRender(); });
            sortByArtistBtn.addEventListener('click', () => { currentSort = 'artist'; updateSortButtons(); filterAndRender(); });
            searchInputEl.addEventListener('input', filterAndRender);
            artistFilterEl.addEventListener('change', filterAndRender);

            // Init
            const { uniqueArtists } = calculateAndDisplayStats();
            setupFilters(uniqueArtists);
            updateSortButtons();
            filterAndRender();

            // Random Modal Logic
            function pickRandomSong() {
                // ... (Existing logic) ...
                const songs = songData.filter(song => {
                    const searchTerm = searchInputEl.value.toLowerCase();
                    const selectedArtist = artistFilterEl.value;
                    return (selectedArtist === 'all' || song.artist === selectedArtist) && 
                           (song.title.toLowerCase().includes(searchTerm) || song.artist.toLowerCase().includes(searchTerm));
                });
                
                if(songs.length > 0) {
                    const random = songs[Math.floor(Math.random() * songs.length)];
                    randomSongTitleEl.textContent = random.title;
                    randomSongArtistEl.textContent = random.artist;
                } else {
                    randomSongTitleEl.textContent = "Nichts gefunden";
                    randomSongArtistEl.textContent = "Filter anpassen";
                }
            }
            function showModal() {
                pickRandomSong();
                randomSongModal.classList.remove('hidden');
                setTimeout(() => {
                    randomSongModal.classList.remove('opacity-0', 'pointer-events-none');
                    randomSongModal.querySelector('.glass-panel').classList.remove('scale-95');
                    randomSongModal.querySelector('.glass-panel').classList.add('scale-100');
                }, 10);
            }
            function hideModal() {
                randomSongModal.classList.add('opacity-0', 'pointer-events-none');
                randomSongModal.querySelector('.glass-panel').classList.remove('scale-100');
                randomSongModal.querySelector('.glass-panel').classList.add('scale-95');
                setTimeout(() => randomSongModal.classList.add('hidden'), 300);
            }
            randomSongBtn.addEventListener('click', showModal);
            rerollBtn.addEventListener('click', pickRandomSong);
            closeModalBtn.addEventListener('click', hideModal);
            randomSongModal.addEventListener('click', (e) => { if(e.target === randomSongModal) hideModal(); });
        });
    </script>
</body>
</html>
